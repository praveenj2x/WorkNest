---
inclusion: always
---

# WorkNest Security & Code Standards

## Security Requirements

### Input Validation & Sanitization
- Always validate and sanitize user inputs before processing
- Use parameterized queries or ORM methods to prevent SQL injection
- Implement proper input length limits and type checking
- Sanitize data before displaying in UI to prevent XSS attacks

### API Security
- Implement proper authentication and authorization for all endpoints
- Use HTTPS for all external communications
- Validate API tokens and session management
- Rate limit API endpoints to prevent abuse
- Never expose sensitive data in API responses or error messages

### Data Protection
- Encrypt sensitive HR data at rest and in transit
- Implement proper access controls based on user roles
- Log security events without exposing sensitive information
- Follow GDPR/privacy compliance for employee data handling

## Code Standards

### TypeScript/JavaScript
- Use TypeScript strict mode for type safety
- Implement proper error handling with try-catch blocks
- Use async/await instead of promise chains for readability
- Follow consistent naming conventions (camelCase for variables, PascalCase for components)

### React/Next.js Patterns
- Use functional components with hooks over class components
- Implement proper state management (useState, useEffect, useContext)
- Use Next.js built-in security features (CSP, CSRF protection)
- Implement proper loading states and error boundaries

### Database Operations
- Use Supabase RLS (Row Level Security) policies
- Implement proper database schema validation
- Use transactions for multi-step operations
- Never construct raw SQL queries from user input

## Integration Security

### Slack API
- Validate webhook signatures from Slack
- Use scoped OAuth tokens with minimal required permissions
- Implement proper token refresh mechanisms

### Google Workspace API
- Use service account authentication where possible
- Implement proper scope limitations for API access
- Validate form submissions and responses

### Kiro Hooks & MCP
- Sanitize all data passed between hooks and MCP modules
- Implement proper error handling for automation failures
- Log automation events for audit trails

## Error Handling
- Never expose internal system details in error messages
- Implement graceful degradation for failed integrations
- Use structured logging for debugging without exposing sensitive data
- Provide user-friendly error messages while maintaining security